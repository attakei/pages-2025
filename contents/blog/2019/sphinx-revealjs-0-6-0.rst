=====================
sphinx-revealjs 0.6.0
=====================

.. post:: 2019-07-31
   :category: Tech
   :tags: Python,Sphinx,Reveal.js,sphinx-revealjs,

自作ライブラリですが、欲しい機能を1個追加してバージョン更新しました。

https://pypi.org/project/sphinx-revealjs/0.6.0/

何を追加したか？
================

ディレクティブとして、新しく ``revealjs_break`` を追加しました。

これは、reSTセクションにおいて、新しくセクションを宣言せずにスライドセクションを作るためのものとなります。

例えば、「ある同じタイトルを持つ連続したスライド群」に対して、今までだと

.. code-block:: rest

    タイトル
    --------

    1枚目の内容

    タイトル
    --------

    2枚目の内容

となっていました。これを、

.. code-block:: rest

    タイトル
    --------

    1枚目の内容

    .. revealjs_break::

    2枚目の内容

という記述で書けるようにしています。

また、 ``:notitle:`` 属性を使うことで、次のセクションではタイトルを表示させないこともできます。

なぜ追加したか？
================

スライドを書いてると、ページのタイトルをしばらく変えずに進むパターンがあります。
もともと、reSTの構造上セクションを区切る手段が「セクションを追加する」しかなく、
結果として同じタイトルが続くとしたら ``sphinx-revealjs`` ではコピペせざるを得ませんでした。

別にこれでもあまり困るケースはないのですが、タイトルを編集した時の手間を考えると、
「タイトルをコピペせずにページ分割」は **自分の中で** 地味に欲しい機能なため、
今回実装することにしました。

他の更新について
================

文法チェック全般をflake8系全振りに
----------------------------------

``Travis-CI`` で行っている文法チェックを整理して、極力 ``flake8`` とそのプラグインへ寄せることにしました。
それに伴い、できる範囲でdocstringも追加するようにしました。

拡張系は、コアとのつなぎ込みになるエントリーポイントを書くときにどうコメントしたらいいですかね？

setup.pyの中身をsetup.cfgへ移動
-------------------------------

ようやく、 ``setup.py`` 中身をすっきりすることができました。

.. raw:: html

    <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">sphinx拡張パッケージのメタデータを全部setup.cfgに寄せてattrを使おうと思ったら、__init__.py内でSphinxをインポートする関係上依存関係を解決できずにちょっと面倒。というのをきれいに解決する方法を探してる</p>&mdash; kAZUYA tAKEI (@attakei) <a href="https://twitter.com/attakei/status/1146199241108275201?ref_src=twsrc%5Etfw">July 2, 2019</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

以前にこんなツイートをしたのですが、これは ``bumpversion`` で対応することにしました。

実行のたびに ``setup.cfg`` を作り直して、Tabでインデントするのが気に食わないけど、一旦このまま運用してみましょう。

ToDo
====

* ドキュメントを直す
* 直したあとぐらいにdev.toにも記事を書いてみる
